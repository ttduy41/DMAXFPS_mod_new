 <!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINHMODLAG V52 - FULL SYSTEM</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00a884; --bg: #f0f2f5; --card: #ffffff; --text: #1c1e21; --border: #e4e6eb; --header: #ffffff; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; overflow-x: hidden; }
        
        /* AUTH SCREEN */
        #authScreen { position: fixed; inset: 0; background: var(--accent); z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .auth-box { background: var(--card); padding: 40px; border-radius: 25px; width: 350px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.2); }

        /* HEADER */
        header { position: fixed; top:0; width:100%; height:75px; background: var(--header); display:flex; align-items:center; padding:0 25px; box-shadow:0 2px 15px rgba(0,0,0,0.1); z-index:1000; box-sizing:border-box; }
        .logo { font-weight:900; font-size: 26px; color:var(--accent); cursor: pointer; }
        .wallet { background:#1a1a1a; color:#00ff88; padding:8px 18px; border-radius:30px; font-weight:bold; margin-left:auto; border: 2px solid var(--accent); font-family: monospace; }

        /* MAIN CONTAINER */
        .container { margin-top:100px; padding:20px; max-width:1100px; margin-inline:auto; }
        .intro-box { background: linear-gradient(135deg, #00a884 0%, #007d63 100%); color: white; padding: 25px; border-radius: 20px; margin-bottom: 25px; }
        
        .shop-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(320px, 1fr)); gap:20px; }
        .product-card { background: var(--card); padding:20px; border-radius:20px; border:1px solid var(--border); text-align:center; transition: 0.3s; }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .stock-badge { font-size: 11px; background: #f0f2f5; padding: 10px; border-radius: 12px; text-align: left; margin-bottom: 15px; border-left: 3px solid var(--accent); line-height: 1.5; }

        input, select, button, textarea { width:100%; padding:13px; margin:8px 0; border-radius:10px; border:1px solid var(--border); box-sizing: border-box; outline: none; font-family: inherit; }
        .btn-buy { background:var(--accent); color:#fff; border:none; font-weight:bold; cursor:pointer; text-transform:uppercase; transition: 0.2s; }
        .btn-buy:disabled { background: #ccc; cursor: not-allowed; }

        /* SIDE MENU */
        #sideMenu { position:fixed; top:0; left:-450px; width:380px; height:100%; background: var(--card); z-index:2000; padding:25px; transition:0.4s; box-shadow:15px 0 40px rgba(0,0,0,0.3); overflow-y:auto; box-sizing:border-box; }
        
        /* ROBOT CONSOLE */
        #robotConsole { background: #000; color: #0f8; padding: 15px; border-radius: 15px; font-family: monospace; margin-top: 15px; border: 1px solid #333; }
        #robotLogs { height: 120px; overflow-y: auto; font-size: 11px; margin-bottom: 10px; border-bottom: 1px solid #222; white-space: pre-wrap; }
        
        /* MODALS */
        .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:5000; align-items:center; justify-content:center; backdrop-filter: blur(5px); }
        .modal-content { background: var(--card); padding:30px; border-radius:25px; width:450px; border:2px solid var(--accent); max-height: 85vh; overflow-y: auto; }
        .hist-item { background: #f8f9fa; padding: 12px; border-radius: 12px; margin-bottom: 8px; border-left: 5px solid var(--accent); text-align: left; font-size: 13px; }
        
        .tab-group { display: flex; gap: 10px; margin-bottom: 15px; }
        .tab-btn { flex: 1; padding: 10px; border-radius: 10px; border: 1px solid var(--border); cursor: pointer; font-weight: bold; background: #fff; text-align: center; font-size: 12px; }
        .tab-btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }
    </style>
</head>
<body>

    <div id="authScreen">
        <div class="auth-box">
            <h1 style="color:var(--accent); font-weight:900; margin:0 0 20px 0;">VINHMODLAG</h1>
            <input type="text" id="uLog" placeholder="T√™n ƒëƒÉng nh·∫≠p...">
            <input type="password" id="pLog" placeholder="M·∫≠t kh·∫©u...">
            <button class="btn-buy" onclick="handleLogin()">ƒêƒÇNG NH·∫¨P</button>
            <p style="font-size:11px; color:#888; margin-top:15px;">Admin: Ho√†ng Vinh - Zalo: 0975651390</p>
        </div>
    </div>

    <div id="app" style="display:none">
        <header>
            <div onclick="toggleMenu(true)" style="font-size:25px; cursor:pointer; color: var(--accent);">‚ò∞</div>
            <div class="logo" style="margin-left:15px;">VINHMODLAG</div>
            <div class="wallet"><span id="userBal">0</span>ƒë</div>
        </header>

        <div id="sideMenu">
            <h2 style="margin-top:0">Ch√†o s·∫øp, <span id="uNameDisp" style="color:var(--accent)"></span></h2>
            <button class="btn-buy" style="background:#333; font-size:12px;" onclick="openModal('modalHistory')">üìä L·ªäCH S·ª¨ GIAO D·ªäCH</button>
            
            <hr style="border:0; border-top:1px solid var(--border); margin:20px 0;">
            
            <div class="tab-group">
                <div class="tab-btn active" id="btnT" onclick="switchPay('the')">TH·∫∫ C√ÄO</div>
                <div class="tab-btn" id="btnB" onclick="switchPay('bank')">CHUY·ªÇN KHO·∫¢N</div>
            </div>

            <div id="payThe">
                <select id="cardType"><option>Viettel</option><option>Mobi</option><option>Vina</option></select>
                <select id="cardVal">
                    <option value="10000">10,000ƒë</option><option value="20000">20,000ƒë</option>
                    <option value="50000">50,000ƒë</option><option value="100000">100,000ƒë</option>
                </select>
                <input id="cardSeri" placeholder="S·ªë Seri..."><input id="cardPin" placeholder="M√£ th·∫ª (PIN)...">
                <button class="btn-buy" onclick="submitCard()">G·ª¨I TH·∫∫ DUY·ªÜT</button>
            </div>

            <div id="payBank" style="display:none; text-align:center;">
                <input type="number" id="bankAmt" placeholder="Nh·∫≠p s·ªë ti·ªÅn...">
                <button class="btn-buy" style="background:#0066ff" onclick="genVietQR()">T·∫†O M√É QR</button>
                <div id="qrBox" style="display:none; margin-top:10px;">
                    <img id="qrImg" style="width:100%; border-radius:15px; border:2px solid var(--accent);">
                    <p style="font-size:11px; color:red; font-weight:bold;" id="qrMsg"></p>
                </div>
            </div>

            <div id="adminArea" style="display:none;">
                <div id="robotConsole">
                    <b>üñ•Ô∏è ROBOT ADMIN SYSTEM</b>
                    <div id="robotLogs">H·ªá th·ªëng s·∫µn s√†ng...</div>
                    <input id="robotInput" placeholder="Nh·∫≠p l·ªánh Robot...">
                    <button onclick="runRobotCmd()" style="background:#0f8; color:#000; font-weight:bold;">TH·ª∞C THI</button>
                    <button onclick="openModal('modalKey')" style="background:#444; color:#fff; font-size:10px; margin-top:5px;">üì¶ NH·∫¨P KHO H√ÄNG</button>
                </div>
            </div>

            <button onclick="logout()" style="color:red; background:none; border:1px solid red; margin-top:30px;">ƒêƒÇNG XU·∫§T</button>
        </div>

        <div class="container">
            <div class="intro-box">
                <h3 style="margin:0">üíé VINHMODLAG V52</h3>
                <p style="font-size:13px; opacity:0.9;">T·ª± ƒë·ªông - Uy t√≠n - Gi√° r·∫ª. Key l·ªói 1 ƒë·ªïi 1.</p>
            </div>
            <div class="shop-grid" id="shopGrid"></div>
        </div>
    </div>

    <div id="modalKey" class="modal"><div class="modal-content">
        <h3>üì¶ NH·∫¨P KHO PH√ÇN LO·∫†I</h3>
        <select id="kProd"><option value="itachi">Itachi Ping V3</option><option value="hopper">Hopper Plus</option><option value="clone">Acc Clone Lv5</option></select>
        <select id="kTime">
            <option>1 Ng√†y</option><option>7 Ng√†y</option><option>30 Ng√†y</option><option>Vƒ©nh Vi·ªÖn</option><option>M·∫∑c ƒë·ªãnh</option>
        </select>
        <textarea id="kInput" rows="6" placeholder="D√°n m√£ v√†o ƒë√¢y, m·ªói d√≤ng 1 m√£..."></textarea>
        <button class="btn-buy" onclick="adminAddStock()">X√ÅC NH·∫¨N N·∫†P KHO</button>
        <button onclick="closeModal('modalKey')">ƒê√ìNG</button>
    </div></div>

    <div id="modalHistory" class="modal"><div class="modal-content">
        <h3>üìä L·ªäCH S·ª¨ GIAO D·ªäCH</h3>
        <div class="tab-group">
            <div class="tab-btn active" id="tBuy" onclick="renderHistory('buy')">ƒê∆†N H√ÄNG</div>
            <div class="tab-btn" id="tCard" onclick="renderHistory('card')">N·∫†P TH·∫∫</div>
        </div>
        <div id="historyDisplay" style="max-height: 400px; overflow-y: auto;"></div>
        <button class="btn-buy" style="background:#333; margin-top:15px;" onclick="closeModal('modalHistory')">QUAY L·∫†I</button>
    </div></div>

    <div id="overlay" onclick="toggleMenu(false)" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1500;"></div>

    <script>
        const STORAGE_KEY = 'VINHMOD_V52_FINAL';
        const SESSION_KEY = 'VINHMOD_V52_SESSION';

        let db = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {
            users: { "vinhmoddz": { pass: "vinhmoddz", bal: 10000000, admin: true, buys: [], cards: [] } },
            prods: [
                { id: 0, slug: "itachi", name: "Itachi Ping V3", plans: { "1 Ng√†y": 10000, "7 Ng√†y": 50000, "30 Ng√†y": 150000, "Vƒ©nh Vi·ªÖn": 500000 }, stock: { "1 Ng√†y": [], "7 Ng√†y": [], "30 Ng√†y": [], "Vƒ©nh Vi·ªÖn": [] } },
                { id: 1, slug: "hopper", name: "Hopper Plus", plans: { "1 Ng√†y": 15000, "7 Ng√†y": 70000, "30 Ng√†y": 200000, "Vƒ©nh Vi·ªÖn": 700000 }, stock: { "1 Ng√†y": [], "7 Ng√†y": [], "30 Ng√†y": [], "Vƒ©nh Vi·ªÖn": [] } },
                { id: 2, slug: "clone", name: "Acc Clone Level 5", plans: { "M·∫∑c ƒë·ªãnh": 20000 }, stock: { "M·∫∑c ƒë·ªãnh": [] } }
            ]
        };

        let curUser = localStorage.getItem(SESSION_KEY) || null;

        function save() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(db));
            if(curUser) renderShop();
        }

        // --- AUTH ---
        function handleLogin() {
            let u = document.getElementById('uLog').value.trim(), p = document.getElementById('pLog').value.trim();
            if(db.users[u] && db.users[u].pass === p) {
                curUser = u; localStorage.setItem(SESSION_KEY, u); initApp();
            } else alert("Sai th√¥ng tin ƒëƒÉng nh·∫≠p s·∫øp ∆°i!");
        }

        function initApp() {
            document.getElementById('authScreen').style.display='none';
            document.getElementById('app').style.display='block';
            document.getElementById('uNameDisp').innerText = curUser;
            document.getElementById('adminArea').style.display = db.users[curUser].admin ? 'block' : 'none';
            renderShop();
        }

        // --- MUA H√ÄNG (CH·ªêNG TR√ôNG 2 L·∫¶N) ---
        function renderShop() {
            document.getElementById('userBal').innerText = db.users[curUser].bal.toLocaleString();
            let grid = document.getElementById('shopGrid'); grid.innerHTML = "";
            db.prods.forEach(p => {
                let sTxt = Object.keys(p.stock).map(k => `<b>${k}:</b> ${p.stock[k].length}`).join(' | ');
                let opts = `<select id="plan-${p.id}">${Object.keys(p.plans).map(k=>`<option value="${k}">${k} - ${p.plans[k].toLocaleString()}ƒë</option>`).join('')}</select>`;
                grid.innerHTML += `
                    <div class="product-card">
                        <div class="stock-badge">üì¶ <b>Kho:</b> ${sTxt}</div>
                        <h2 style="margin:10px 0;">${p.name}</h2>
                        ${opts}
                        <button class="btn-buy" id="btnBuy-${p.id}" onclick="buyProcess(event, ${p.id})">MUA NGAY</button>
                    </div>`;
            });
        }

        function buyProcess(e, id) {
            let btn = e.target;
            if(btn.disabled) return; // B·∫£o v·ªá: N·∫øu n√∫t ƒëang b·ªã kh√≥a th√¨ kh√¥ng ch·∫°y n·ªØa
            
            let p = db.prods[id], plan = document.getElementById(`plan-${id}`).value, cost = p.plans[plan];

            if(db.users[curUser].bal < cost) return alert("H·∫øt ti·ªÅn n·∫°p th√™m s·∫øp ∆°i!");
            if(!p.stock[plan] || p.stock[plan].length === 0) return alert("G√≥i n√†y ƒëang ch√°y h√†ng!");

            btn.disabled = true; // Kh√≥a n√∫t ngay l·∫≠p t·ª©c
            btn.innerText = "ƒêANG X·ª¨ L√ù...";

            setTimeout(() => { // T·∫°o ƒë·ªô tr·ªÖ nh·∫π ƒë·ªÉ h·ªá th·ªëng l∆∞u file chu·∫©n
                let key = p.stock[plan].shift(); 
                db.users[curUser].bal -= cost;
                db.users[curUser].buys.unshift({ name: p.name, plan: plan, key: key, time: new Date().toLocaleString() });
                
                save(); 
                alert(`MUA TH√ÄNH C√îNG!\nM√£ c·ªßa s·∫øp l√†: ${key}`);
                
                btn.disabled = false;
                btn.innerText = "MUA NGAY";
                renderShop();
            }, 500);
        }

        // --- ROBOT COMMAND CENTER ---
        function runRobotCmd() {
            let cmd = document.getElementById('robotInput').value.trim(), p = cmd.split(" ");
            let log = document.getElementById('robotLogs');

            if(p[0] === ".chuyentien" && p[3] === "chuyen") {
                let u = p[1], v = parseInt(p[2]);
                if(db.users[u]) {
                    db.users[u].bal += v;
                    db.users[u].cards.unshift({ t: 'Robot', v: v, pin: 'AUTO_PAY', st: 'Th√†nh c√¥ng', time: new Date().toLocaleString() });
                    log.innerHTML += `\n‚úÖ ƒê√£ chuy·ªÉn ${v}ƒë cho ${u}`; save();
                } else log.innerHTML += `\n‚ùå Kh√¥ng th·∫•y s·∫øp ${u}`;
            }
            else if(p[0] === ".trutien" && p[3] === "tru") {
                let u = p[1], v = parseInt(p[2]);
                if(db.users[u]) { db.users[u].bal -= v; log.innerHTML += `\n‚úÖ ƒê√£ tr·ª´ ${v}ƒë c·ªßa ${u}`; save(); }
            }
            else if(p[0] === ".checkthe") {
                let list = "";
                Object.keys(db.users).forEach(u => {
                    db.users[u].cards.forEach(c => { if(c.st === 'Ch·ªù duy·ªát') list += `\nüë§ ${u}: ${c.v}ƒë (PIN: ${c.pin})`; });
                });
                log.innerHTML += list || "\nüì≠ Kh√¥ng c√≥ th·∫ª n√†o!";
            }
            else if(p[0] === ".duyet" && p[3] === "thanhcong") {
                let u = p[1], pin = p[2], f = false;
                if(db.users[u]) {
                    db.users[u].cards.forEach(c => {
                        if(c.pin === pin && c.st === 'Ch·ªù duy·ªát') { c.st = 'Th√†nh c√¥ng'; db.users[u].bal += parseInt(c.v); f = true; }
                    });
                    if(f) { log.innerHTML += `\n‚úÖ ƒê√£ duy·ªát th·∫ª cho ${u}`; save(); }
                }
            }
            else if(p[0] === ".xoakho") {
                let slug = p[1], pr = db.prods.find(x => x.slug === slug);
                if(pr) { Object.keys(pr.stock).forEach(k => pr.stock[k] = []); log.innerHTML += `\n‚úÖ Kho ${slug} ƒë√£ s·∫°ch!`; save(); }
            }
            else { log.innerHTML += "\n‚ùå Sai l·ªánh s·∫øp ∆°i!"; }
            log.scrollTop = log.scrollHeight;
            document.getElementById('robotInput').value = "";
        }

        // --- UTILS ---
        function adminAddStock() {
            let slug = document.getElementById('kProd').value, time = document.getElementById('kTime').value, raw = document.getElementById('kInput').value.trim();
            let pr = db.prods.find(x => x.slug === slug);
            if(raw && pr.stock[time]) {
                pr.stock[time].push(...raw.split('\n').filter(k => k.trim() !== ""));
                save(); closeModal('modalKey'); document.getElementById('kInput').value = ""; alert("ƒê√£ n·∫°p kho!");
            }
        }

        function submitCard() {
            let s = document.getElementById('cardSeri').value, p = document.getElementById('cardPin').value;
            if(!s || !p) return alert("Nh·∫≠p ƒë·ªß Seri v√† M√£ th·∫ª!");
            db.users[curUser].cards.unshift({ t: document.getElementById('cardType').value, v: document.getElementById('cardVal').value, pin: p, st: 'Ch·ªù duy·ªát', time: new Date().toLocaleString() });
            save(); alert("ƒê√£ g·ª≠i th·∫ª! ƒê·ª£i Admin duy·ªát s·∫øp nh√©.");
        }

        function renderHistory(m) {
            let d = document.getElementById('historyDisplay'); d.innerHTML = "";
            document.getElementById('tBuy').className = m==='buy'?'tab-btn active':'tab-btn';
            document.getElementById('tCard').className = m==='card'?'tab-btn active':'tab-btn';
            if(m === 'buy') {
                db.users[curUser].buys.forEach(b => { d.innerHTML += `<div class="hist-item"><b>${b.name}</b> (${b.plan})<br><span style="color:red;font-weight:bold;">KEY: ${b.key}</span><br><small>${b.time}</small></div>`; });
            } else {
                db.users[curUser].cards.forEach(c => { d.innerHTML += `<div class="hist-item"><b>${c.t} ${c.v}ƒë</b> - <i>${c.st}</i><br>PIN: ${c.pin}<br><small>${c.time}</small></div>`; });
            }
        }

        function genVietQR() {
            let a = document.getElementById('bankAmt').value; if(a < 1000) return alert("N·∫°p √≠t nh·∫•t 1k s·∫øp ∆°i!");
            let msg = "NAP " + curUser.toUpperCase();
            document.getElementById('qrImg').src = `https://img.vietqr.io/image/MB-0975651390-compact2.jpg?amount=${a}&addInfo=${msg}`;
            document.getElementById('qrMsg').innerText = "N·ªòI DUNG: " + msg;
            document.getElementById('qrBox').style.display = 'block';
        }

        function switchPay(t) {
            document.getElementById('payThe').style.display = t==='the'?'block':'none';
            document.getElementById('payBank').style.display = t==='bank'?'block':'none';
            document.getElementById('btnT').className = t==='the'?'tab-btn active':'tab-btn';
            document.getElementById('btnB').className = t==='bank'?'tab-btn active':'tab-btn';
        }

        function toggleMenu(s) { document.getElementById('sideMenu').style.left = s?'0':'-450px'; document.getElementById('overlay').style.display = s?'block':'none'; }
        function openModal(id) { document.getElementById(id).style.display = 'flex'; if(id==='modalHistory') renderHistory('buy'); }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function logout() { localStorage.removeItem(SESSION_KEY); location.reload(); }
        
        if(curUser) initApp();
    </script>
</body>
          </html>
  
